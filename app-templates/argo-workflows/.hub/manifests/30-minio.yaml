---
components:
- name: minio-source
  source:
    repoUrl: https://github.com/agilestacks/applications.git
    repoPath: applications/components/minio-bucket
    dir: components/minio-bucket
    branch: master
    fromEnv: GITHUB_TOKEN
- name: minio-target
  source:
    repoUrl: https://github.com/agilestacks/applications.git
    repoPath: applications/components/minio-bucket
    dir: components/minio-bucket
    branch: master
    fromEnv: GITHUB_TOKEN

lifecycle:
  bare: allow
  verbs: [deploy, undeploy]
  order:
    - minio-source
    - minio-target
  mandatory:
    - minio-source
    - minio-target

parameters:
- name: cloud.region
- name: terraform.bucket
  parameters:
  - name: name
  - name: region
- name: component.ingress
  parameters:
  - name: protocol
- name: component.bucket
  component: source-bucket
  parameters:
  - name: endpoint
  - name: name
    value: ${application.name}-input
  - name: namespace
  - name: secret.name
  - name: secret.namespace
  - name: secret.accessKeyRef
  - name: secret.secretKeyRef
- name: component.bucket
  component: target-bucket
  parameters:
  - name: endpoint
  - name: name
    value: ${application.name}-output
  - name: namespace
  - name: secret.name
  - name: secret.namespace
  - name: secret.accessKeyRef
  - name: secret.secretKeyRef

- name: component.nats.fqdn
