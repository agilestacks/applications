---
apiVersion: "jenkins.agilestacks.com/v1"
kind: EnvVars
metadata:
  name: ${component.jenkins-pipeline.application}
spec:
  merge: their
  variables:
    ${component.jenkins-pipeline.stateFile}: ${component.jenkins-pipeline.stateFileS3}
---
apiVersion: v1
kind: Secret
metadata:
  name: ${component.jenkins-pipeline.credentialsName}
  namespace: jenkins
  labels:
    provider: agilestacks.com
    project: jenkins
    qualifier: credentials
data:
  deployKey: ${component.jenkins-pipeline.deployKey}
---
apiVersion: "jenkins.agilestacks.com/v1"
kind: Credentials
metadata:
  name: ${component.jenkins-pipeline.credentialsName}
spec:
  domain: global
  description: Git credentials for application-name
  usernamePassword:
    username: ${component.jenkins-pipeline.credentialsName}
    password:
      secretKeyRef:
        name: ${component.jenkins-pipeline.credentialsName}
        key: deployKey
---
apiVersion: "jenkins.agilestacks.com/v1"
kind: Pipeline
metadata:
  name: ${component.jenkins-pipeline.application}
spec:
  repositoryUrl: ${component.jenkins-pipeline.repositoryUrl}
  #folder: sample-pipelines
  credentialsId: ${component.jenkins-pipeline.credentialsName}
  branchSpec: '*/master'
  pipeline: Jenkinsfile
  origin: 'SuperHub'
