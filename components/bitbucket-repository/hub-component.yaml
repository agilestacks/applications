---
version: 1
kind: component
meta:
  name: bitbucket
  brief: Encapsulates operations with Bitbucket
parameters:
- name: component.git
  parameters:
  - name: user.name
    value: SuperHub
    env: USER_NAME
  - name: user.email
    value: support@agilestacks.io
    env: USER_EMAIL
- name: component.bitbucket
  parameters:
  - name: user.name
    env: BITBUCKET_USER
  - name: token
    env: BITBUCKET_TOKEN
    empty: allow
  - name: server.url
    value: https://api.bitbucket.org/2.0
    env: BASE_URL
  - name: workspace
    value: ../../../
    env: SRC_DIR
  - name: project.key
    env: PROJECT_KEY
    empty: allow
  - name: repository.name
    env: REPO_NAME
    value: vikt999
  - name: project.private
    value: true
    env: PRIVATE
  - name: project.description
    env: PROJECT_DESCRIPTION
    empty: allow
  - name: team.name
    env: TEAM_NAME
    empty: allow  

outputs:
- name: component.git.remote
  fromTfVar: clone_url
- name: component.bitbucket.project.cloneUrl
  fromTfVar: clone_url
- name: component.bitbucket.project.gitUrl
  fromTfVar: git_url
- name: component.bitbucket.project.htlmUrl
  fromTfVar: html_url
- name: component.bitbucket.project.sshUrl
  fromTfVar: ssh_url

templates:
  files:
  - "templates/*.template" 
